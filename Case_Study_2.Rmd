---
title: "Case Study 2"
author: "Michael Daniel Bigler and Liam Arthur Phan"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    code_folding: hide
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(
	message = FALSE,
	warning = FALSE,
	include = TRUE,
	fig.align = "center")
rm(list = ls())
cat("\014")

```

<break>

> Goal:

# Packages

> In the following all the packages needed for this case study are loaded.

```{r packages}

library(ggplot2)
library(DT)
library(jtools)
library(kableExtra)
library(pastecs)
library(rcompanion)   #Histogram and Normal Curve
library(nortest) #Kolmogorov-Smirnov-Test
library(corrplot) #correlation matrix plot
library(olsrr)  #VIF and Tolerance Values
library(dplyr)
library(pastecs)
library(REdaS) #Bartelett's Test
library(psych)
library(lm.beta)
library(RColorBrewer)

```

# Data

> . The source is thereby listed below.

> Source: **Advanced Data Driven Decision Making** [S401024](https://moodle.unige.ch/course/view.php?id=2675 "2675") - University of Geneva (GSEM)
>
> Marcel Paulssen, Professor\
> Fereshteh Vahidi, Teaching Assistant\
> Anastasia Floru, Teaching Assistant

```{r data loading}
Mydata <- read.csv("DATA/Data File_Case_Study_Factor Analysis_MD.csv", header=TRUE)

# selecting questions
Mydata_with_y <- Mydata[,c(9:41, 43:45, 51:52)]
Mydata_with_y <- na.omit(Mydata_with_y)
Mydata_qd <- Mydata_with_y[,1:33]
rm(Mydata)
```

## Data Analysis

```{r}
list_na =colnames(Mydata_with_y)[apply(Mydata_with_y,2,anyNA)]
list_na
```

## Data Statistics Summary

```{r}

Stat_Desc <- stat.desc(Mydata_with_y, norm=TRUE)

DT::datatable(round(Stat_Desc,3))

```

> All Normality Test are rejected, thus not normal data distributions. 

## Correlation Plot

```{r}

cor_mat <- cor(Mydata_with_y)
corrplot(as.matrix(cor_mat), type="upper", order="hclust", tl.col="black", tl.srt=45,tl.cex = 0.5)

```

## Anti-image correlation, KMO and Bartlett's test

```{r}
KMOTEST=KMOS(Mydata_qd)
KMOTEST
```

```{r}
bart_spher(Mydata_qd, use="complete.obs")
```

```{r}
sort(KMOTEST$MSA)
```

```{r}
KMOTEST=KMOS(Mydata_qd)
KMOTEST$KMO
```

# 1. Orthogonal Factor Analysis

## 1.1  Principal axes factoring with varimax

```{r}
fa_result <- fa(Mydata_qd, nfactors = 9, rotate = "varimax", fm = "pa")
print(fa_result$loadings, cutoff=0.3,sort=TRUE)
```

## 1.4 Final Factor Solutions
